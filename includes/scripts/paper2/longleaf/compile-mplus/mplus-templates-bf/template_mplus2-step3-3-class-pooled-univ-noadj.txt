[[init]]
iterators = distalv trajvar numclasses;

distalv = 1:3;
trajvar = 1:3;
numclasses = 3;

trajvarnames#trajvar = "wt" "ht" "wfl";
distalnames#distalv = "ldl" "hdl" "log_tg";

filename = "step3-pooled--distal-[[distalnames#distalv]]--[[trajvarnames#trajvar]]--outcome--[[numclasses]]-Classes.inp";

outputDirectory = "/proj/epi/CVDGeneNas/avonholle/ms-d2/data-prep-bf/mplus-templates/pooled/univ-noadj/step3";

[[/init]]

TITLE: Step 1. [[numclasses]] class quadratic growth model for CFA distal, BCH approach. No adjust

DATA: FILE = "../step1-pooled--[[trajvarnames#trajvar]]--outcome--[[numclasses]]-Classes.dat";

VARIABLE: 
NAMES = 
   [[trajvarnames#trajvar]]0 - [[trajvarnames#trajvar]]5 
   hdl
   ldl
   log_tg
   sex
   graffar_
   mk2
    BCHW1          
    BCHW2          
    bchw3
    ID;

MISSING=*;

CLASSES = uc([[numclasses]]);

IDVARIABLE is ID;

USEVARIABLES =  
    bchw1 bchw2  bchw3
    [[distalnames#distalv]];

TRAINING = BCHW1-BCHW3 (bch);

ANALYSIS:	
  TYPE = MIXTURE ;
  starts=0;
 
MODEL:

	%OVERALL%

	! latent class variable and distal outcome
	! See section 3.2 of Asparouhov 2014 paper on bch method in mplus

    %uc#1%

    [[[distalnames#distalv]]] (a1);
    [[distalnames#distalv]];

    %uc#2%

    [[[distalnames#distalv]]] (a2);
    [[distalnames#distalv]];

    %uc#3%

    [[[distalnames#distalv]]] (a3);
    [[distalnames#distalv]];

MODEL TEST:
  0 = a1 - a2;
  0 = a1 - a3;

MODEL CONSTRAINT:
  new (diff1-diff3);
  diff1 = a1 - a2;
  diff2 = a1 - a3;
  diff3 = a2 - a3;

OUTPUT: 
    standardized sampstat;
